<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>ì¹˜í‚¨ ì–´ë•Œ ğŸ—</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    {#
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" #}
          {# integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" #}
          {# crossorigin="anonymous">
    #}

    <!-- í°íŠ¸-->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Hahmlet:wght@400&display=swap"
          rel="stylesheet">
    <!-- css íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° (ë°°ë„ˆ, ë°°ê²½)-->
    <link href='{{ url_for("static", filename="mystyle.css") }}' rel="stylesheet">

    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            crossorigin="anonymous"></script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <script src="/static/myjs.js"></script>
    <style>

        /*ê²€ìƒ‰ì°½ css*/
        .search-box {
            width: 30%;
            margin-bottom: 20px;
            margin-left: auto;
            max-width: 300px;
        }

        /*ì¢‹ì•„ìš” ë²„íŠ¼ */
        .like {
            float: right;
        }

        .like-num {
            font-size: medium;
        }

        /*ì¹˜í‚¨ ì´ë¯¸ì§€ í¬ê¸°*/
        .card-img-top {
            height: 320px;
        }

        /*ê²€ìƒ‰ í›„ highlight í‘œì‹œ ìƒ‰ê¹”*/
        div.highlight {
            background: RGBA(255, 222, 89);
        }


    </style>

    <script>

        //**ê²€ìƒ‰ ê¸°ëŠ¥**//

        // dbì— ì €ì¥ëœ chickens dataset ë°›ê¸° (jinja2)
        let chickens = {{ chickens | tojson }} ;
        // chickens ë°ì´í„° ì† ì´ë¦„ë§Œ listì— ë„£ê¸°
        let chicken_list = [];
        for (let i = 0; i < chickens.length; i++) {
            chicken_list.push(chickens[i]["name"])
        }
        console.log(chicken_list)

        // ê²€ìƒ‰ì–´ê°€ ì¹˜í‚¨ ì´ë¦„ listì— ë“¤ì—ˆëŠ”ì§€ ì—¬ë¶€ í™•ì¸
        function find_chicken() {
            let chicken = $("#input-chicken").val().toLowerCase()
            if (chicken == "") {
                // ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì§€ ì•Šì€ ê²½ìš°, ë©”ì‹œì§€
                alert("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”")
                return
            }
            if (chicken_list.includes(chicken)) {
                //ê²€ìƒ‰ì–´ê°€ ì¹˜í‚¨ ì´ë¦„ ë¦¬ìŠ¤íŠ¸ì— ìˆìœ¼ë©´ ë©”ì‹œì§€ì™€ í•´ë‹¹ ì¹´ë“œ í•˜ì´ë¼ì´íŠ¸
                alert('ì°¾ì•˜ìŠµë‹ˆë‹¤!')
                // í•´ë‹¹ ë°•ìŠ¤ íƒœê·¸ì— í•˜ì´ë¼ì´íŠ¸ ì ìš©ë˜ëŠ” class ì¶”ê°€í•˜ê¸°
                $(`#chicken-${chicken}`).addClass("highlight")
                // í•´ë‹¹ ë°•ìŠ¤ë¥¼ ì œì™¸í•œ í˜•ì œ ìš”ì†Œì˜ í•˜ì´ë¼ì´íŠ¸ ì ìš©ë˜ëŠ” class ì œê±°í•˜ê¸°
                $(`#chicken-${chicken}`).siblings().removeClass("highlight")
                // í•˜ì´ë¼ì´íŠ¸í•œ í•´ë‹¹ ë°•ìŠ¤ ë¶€ë¶„ì´ ë³´ì´ë„ë¡ ìŠ¤í¬ë¡¤
                $(`#chicken-${chicken}`)[0].scrollIntoView()

            } else {
                //ë¦¬ìŠ¤íŠ¸ì— ì—†ìœ¼ë©´ ë©”ì‹œì§€ í›„ ìƒˆë¡œê³ ì¹¨
                alert('ê·¸ëŸ° ì¹˜í‚¨ì€ ì—†ì–´ìš”...')
                window.location.href = '/'
            }
        }

    </script>
</head>
<body>
<div class="wrap">
<!--ë°°ë„ˆ êµ¬ì—­-->
    <!--    ë¡œê·¸ ì•„ì›ƒ ë²„íŠ¼ í´ë¦­ ì‹œ, sign_out í•¨ìˆ˜ ì‹¤í–‰-->
    <a href="" class="badge rounded-pill bg-secondary logout" style="text-decoration-line: none" onclick="sign_out()">ë¡œê·¸ì•„ì›ƒ</a>
    <!--    ë°°ë„ˆ í´ë¦­ ì‹œ, ë©”ì¸ í˜ì´ì§€ ì´ë™-->
    <div class="banner" onclick="window.location.href = '/'"></div>

    <div class="contents">
        <div class="search-box d-flex justify-content-center">
            <!--    ê²€ìƒ‰ ì°½ : ì…ë ¥ í›„ í´ë¦­ ì‹œ í•¨ìˆ˜ find_chicken() ì‹¤í–‰-->
            <input id="input-chicken" class="form-control" style="margin-right: 0.5rem; border-color: #ffc107;"
                   placeholder="ì´ ì¹˜í‚¨ì€ ì–´ë•Œ?">
            <button class="btn btn-outline-warning" onclick="find_chicken()"><i class="fa fa-search"></i></button>
        </div>

        <div class="row row-cols-1 row-cols-md-3 g-4">
            <!--    ì„œë²„ì—ì„œ ì „ë‹¬ë°›ì€ chickens ë°ì´í„°ë¡œ forë¬¸ì„ ëŒë ¤ ê° ì¹˜í‚¨ë§ˆë‹¤ ì¹´ë“œ ìƒì„±-->
            <!--    1. for ë¬¸ ì‹œì‘-->
            {% for chicken in chickens %}
            <div class="col" id="chicken-{{ chicken.name }}" >
                <div class="card h-100" id="{{chicken._id}}">
                    <!--    ì¹˜í‚¨ ì´ë¯¸ì§€ì™€ ì´ë¦„ í´ë¦­í•˜ë©´ ìƒì„¸í˜ì´ì§€ë¡œ ì´ë™-->
                    <a href="/detail/{{ chicken.name }}">
                        <img src="{{ chicken.img_url }}" class="card-img-top h-70" alt="..."></a>
                    <div class="card-body" >
                        <h5 class="card-title"><a href="/detail/{{ chicken.name }}"
                                                  style="text-decoration-line : none; color: black;">{{ chicken.name }}

                            <!--    ì¢‹ì•„ìš” ë²„íŠ¼ : í´ë¦­ ì‹œ ì¢‹ì•„ìš” ê¸°ëŠ¥ í•¨ìˆ˜ ì‹¤í–‰-->
                            <a href="#" onclick="toggle_like('{{ chicken._id }}', 'up')"
                               class="card-footer-item has-text-info type like " aria-label="up"
                               style="text-decoration-line : none; color:darkorange;">

                                <!--   1-1) í•´ë‹¹ ìœ ì €ê°€ ì¢‹ì•„ìš” ëˆ„ë¥¸ ì ì´ ìˆëŠ”ì§€ ì—¬ë¶€ì— ë”°ë¥¸ ifë¬¸ ì‹œì‘-->
                                {% if chicken.heart_by_me == True %}
                                    <!--   1-2) ë‚´ê°€ í•´ë‹¹ ì¹˜í‚¨ì„ ì¢‹ì•„ìš” ëˆ„ë¥¸ ì  ìˆì„ ë•Œ, ì±„ì›Œì§„ ì•„ì´ì½˜ì´ ë³´ì´ë„ë¡ ì„¤ì •-->
                                      <span class="icon"><i class="fa fa-thumbs-up" aria-hidden="true"></i>
                                    </span>

                                    <!--   2-1) ì¢‹ì•„ìš” ìˆ˜ê°€ 0ì¼ ê²½ìš° ë³´ì´ì§€ ì•Šë„ë¡ ifë¬¸ ì‹œì‘-->
                                    {% if chicken.count_heart == 0 %}
                                        <span  class="like-num"></span>
                                    {% else %} <span class="like-num">{{chicken.count_heart}}</span>
                                    {% endif %}
                                    <!--   2-2) ì¢‹ì•„ìš” ìˆ˜ê°€ 0ì¼ ê²½ìš° ë³´ì´ì§€ ì•Šë„ë¡ ifë¬¸ ì¢…ë£Œ-->

                                <!--   1-3) ë‚´ê°€ í•´ë‹¹ ì¹˜í‚¨ì„ ì¢‹ì•„ìš” ëˆ„ë¥¸ ì  ì—†ì„ ë•Œ, ë¹„ì›Œì§„ ì•„ì´ì½˜ì´ ë³´ì´ë„ë¡ ì„¤ì •-->
                                {% else %}
                                <span class="icon"><i class="fa fa-thumbs-o-up" aria-hidden="true"></i>
                                                    </span>
                                    <!--   2-1) ì¢‹ì•„ìš” ìˆ˜ê°€ 0ì¼ ê²½ìš° ë³´ì´ì§€ ì•Šë„ë¡ ifë¬¸ ì‹œì‘-->
                                    {% if chicken.count_heart == 0 %}
                                        <span  class="like-num"></span>
                                    {% else %} <span  class="like-num">{{chicken.count_heart}}</span> {% endif %}
                                    <!--   2-2) ì¢‹ì•„ìš” ìˆ˜ê°€ 0ì¼ ê²½ìš° ë³´ì´ì§€ ì•Šë„ë¡ ifë¬¸ ì¢…ë£Œ-->

                                {% endif %}
                                <!--   1-4) í•´ë‹¹ ìœ ì €ê°€ ì¢‹ì•„ìš” ëˆ„ë¥¸ ì ì´ ìˆëŠ”ì§€ ì—¬ë¶€ì— ë”°ë¥¸ ifë¬¸ ì¢…ë£Œ-->
                            </a>
                        </h5>
                        <p class="card-text"><small class="text-muted">{{ chicken.brand }}</small></p>

                    </div>
                </div>
            </div>
            {% endfor %}
            <!--    2. for ë¬¸ ì¢…ë£Œ-->
        </div>


    </div>
</div>


</body>
</html>